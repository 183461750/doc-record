# 从Docsify迁移到Docusaurus指南

## 迁移概述

本指南将帮助您将文档从Docsify迁移到Docusaurus。Docusaurus提供了更强大的功能，包括自动生成侧边栏、国际化支持、搜索功能等。

## 迁移步骤

### 1. 安装Docusaurus

```bash
npm init
npm install --save @docusaurus/core @docusaurus/preset-classic @mdx-js/react clsx prism-react-renderer react react-dom
npm install --save-dev @docusaurus/module-type-aliases @docusaurus/tsconfig @docusaurus/types typescript
```

### 2. 创建Docusaurus配置文件

在项目根目录创建`docusaurus.config.ts`文件：

```typescript
import {themes as prismThemes} from 'prism-react-renderer';
import type {Config} from '@docusaurus/types';
import type * as Preset from '@docusaurus/preset-classic';

const config: Config = {
  title: 'Doc Record',
  tagline: '个人文档记录',
  favicon: 'img/favicon.ico',

  url: 'https://your-docusaurus-site.example.com',
  baseUrl: '/',

  organizationName: 'your-github-username', 
  projectName: 'doc-record',

  onBrokenLinks: 'throw',
  onBrokenMarkdownLinks: 'warn',

  i18n: {
    defaultLocale: 'zh-Hans',
    locales: ['zh-Hans'],
  },

  presets: [
    [
      'classic',
      {
        docs: {
          sidebarPath: './sidebars.ts',
          routeBasePath: '/', // 将文档设置为首页
        },
        blog: false, // 禁用博客功能
        theme: {
          customCss: './src/css/custom.css',
        },
      } satisfies Preset.Options,
    ],
  ],

  themeConfig: {
    navbar: {
      title: 'Doc Record',
      logo: {
        alt: 'Doc Record Logo',
        src: 'img/logo.svg',
      },
      items: [
        {
          type: 'docSidebar',
          sidebarId: 'docSidebar',
          position: 'left',
          label: '文档',
        },
        {
          href: 'https://github.com/your-github-username/doc-record',
          label: 'GitHub',
          position: 'right',
        },
      ],
    },
    footer: {
      style: 'dark',
      links: [
        {
          title: '文档',
          items: [
            {
              label: '首页',
              to: '/',
            },
          ],
        },
      ],
      copyright: `Copyright © ${new Date().getFullYear()} Doc Record. Built with Docusaurus.`,
    },
    prism: {
      theme: prismThemes.github,
      darkTheme: prismThemes.dracula,
    },
  } satisfies Preset.ThemeConfig,
};

export default config;
```

### 3. 创建侧边栏配置

创建`sidebars.ts`文件，启用自动生成侧边栏功能：

```typescript
import type {SidebarsConfig} from '@docusaurus/plugin-content-docs';

const sidebars: SidebarsConfig = {
  // 自动从文档文件夹结构生成侧边栏
  docSidebar: [{type: 'autogenerated', dirName: '.'}],
};

export default sidebars;
```

### 4. 迁移文档内容

1. 将现有的Docsify文档从`docs/`目录复制到Docusaurus的`docs/`目录
2. 调整文档格式以适应Docusaurus：
   - 添加前置元数据（Front Matter）到每个Markdown文件
   - 示例：
     ```markdown
     ---
     id: page-id
     title: 页面标题
     sidebar_label: 侧边栏标签
     ---
     
     # 页面内容
     ```
   - 对于包含特殊字符（如问号、空格等）的文件名，必须添加自定义slug以避免路径解析错误：
     ```markdown
     ---
     slug: /custom/path/without-special-chars
     title: 包含特殊字符的标题？
     sidebar_label: 简化的侧边栏标签
     ---
     ```

### 5. 更新package.json脚本

更新`package.json`文件中的脚本：

```json
{
  "scripts": {
    "docusaurus": "docusaurus",
    "start": "docusaurus start",
    "build": "docusaurus build",
    "swizzle": "docusaurus swizzle",
    "deploy": "docusaurus deploy",
    "clear": "docusaurus clear",
    "serve": "docusaurus serve",
    "write-translations": "docusaurus write-translations",
    "write-heading-ids": "docusaurus write-heading-ids",
    "typecheck": "tsc"
  }
}
```

### 6. 创建必要的目录结构

```bash
mkdir -p src/css
mkdir -p static/img
```

### 7. 创建自定义CSS文件

创建`src/css/custom.css`文件：

```css
:root {
  --ifm-color-primary: #2e8555;
  --ifm-color-primary-dark: #29784c;
  --ifm-color-primary-darker: #277148;
  --ifm-color-primary-darkest: #205d3b;
  --ifm-color-primary-light: #33925d;
  --ifm-color-primary-lighter: #359962;
  --ifm-color-primary-lightest: #3cad6e;
  --ifm-code-font-size: 95%;
  --docusaurus-highlighted-code-line-bg: rgba(0, 0, 0, 0.1);
}

[data-theme='dark'] {
  --ifm-color-primary: #25c2a0;
  --ifm-color-primary-dark: #21af90;
  --ifm-color-primary-darker: #1fa588;
  --ifm-color-primary-darkest: #1a8870;
  --ifm-color-primary-light: #29d5b0;
  --ifm-color-primary-lighter: #32d8b4;
  --ifm-color-primary-lightest: #4fddbf;
  --docusaurus-highlighted-code-line-bg: rgba(0, 0, 0, 0.3);
}
```

## 迁移后的优势

1. **自动生成侧边栏**：不再需要手动维护侧边栏或使用脚本生成
2. **更好的搜索功能**：内置搜索或集成Algolia DocSearch
3. **国际化支持**：轻松添加多语言支持
4. **版本控制**：支持文档版本控制
5. **更丰富的主题和插件**：可扩展性更强

## 启动新站点

```bash
npm start
```

## 构建静态站点

```bash
npm run build
npm run serve # 预览构建结果
```

## 注意事项

1. Docusaurus使用React构建，如果需要自定义组件，需要了解React基础
2. 迁移过程中可能需要调整部分Markdown语法以适应MDX格式
3. 图片和其他静态资源需要移动到`static`目录下

## 参考资源

- [Docusaurus官方文档](https://docusaurus.io/docs)
- [Markdown特性](https://docusaurus.io/docs/markdown-features)
- [配置参考](https://docusaurus.io/docs/api/docusaurus-config)